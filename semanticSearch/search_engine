{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"search_engine","provenance":[],"collapsed_sections":[],"mount_file_id":"1q5nUN_HeJur9PCTOqJ6b2yo2T3Pz-sMj","authorship_tag":"ABX9TyNCBZkJhC8L6DZkmcP34lkl"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"67517fa2e23d4ea8a0296a6db12f6bd7":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_0ca103ac85d6427fa88a6b08e6d8d1e1","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_575a11f2feec4dd683402516b7014ca8","IPY_MODEL_275ed95102f4445383792a06ce4d608b","IPY_MODEL_8fe91b39d5b6459f8695a7726a2df0d8"]}},"0ca103ac85d6427fa88a6b08e6d8d1e1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"575a11f2feec4dd683402516b7014ca8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_03f6432e215c46bc9c609ae5281c9e5b","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Downloading: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ed1a4a4aa0104bf1a5400cab38cb8158"}},"275ed95102f4445383792a06ce4d608b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_ebf928a1f911477bbd9ec6db0dbb95e2","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":480,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":480,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_3f9d9664cc5b485dbd2de305375f75d7"}},"8fe91b39d5b6459f8695a7726a2df0d8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_26ddb68eed5343c18c831fc7bbb8df86","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 480/480 [00:00&lt;00:00, 11.7kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c940bd8e9fc14db4b6befce11d825716"}},"03f6432e215c46bc9c609ae5281c9e5b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"ed1a4a4aa0104bf1a5400cab38cb8158":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ebf928a1f911477bbd9ec6db0dbb95e2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"3f9d9664cc5b485dbd2de305375f75d7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"26ddb68eed5343c18c831fc7bbb8df86":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"c940bd8e9fc14db4b6befce11d825716":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1b360db2e53046e39cc76f1c3a3eb05a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_24e881730e67439796584e0bf708e91e","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_8d3db2da745e40b89a2806077e24f3bc","IPY_MODEL_6d78efbefc13461ea3e50783d81aa3d4","IPY_MODEL_acd5265dae0e4d638942a0a5b8976f98"]}},"24e881730e67439796584e0bf708e91e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8d3db2da745e40b89a2806077e24f3bc":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_9e61553db0794ca1b033815aa163731f","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Downloading: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_da3d0cd7a2c748079044025941bbc5d5"}},"6d78efbefc13461ea3e50783d81aa3d4":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_8a2fe804a96142558fd7bb50db10077e","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":645,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":645,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_84327822414749e088d08993042f9dc1"}},"acd5265dae0e4d638942a0a5b8976f98":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_081c6d2b7d9448d098534ab2ae0b0eb6","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 645/645 [00:00&lt;00:00, 15.3kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_69fb88125f9c438a97010cc5864220e4"}},"9e61553db0794ca1b033815aa163731f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"da3d0cd7a2c748079044025941bbc5d5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8a2fe804a96142558fd7bb50db10077e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"84327822414749e088d08993042f9dc1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"081c6d2b7d9448d098534ab2ae0b0eb6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"69fb88125f9c438a97010cc5864220e4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0f1bb27453e54a958b4a65288c47b8a6":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_eb41ed4e01e84561b5db728ed9ac56c1","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_b001709b844b4b81a1f4ea1bcdab1e23","IPY_MODEL_ee89606ed52941c0bd088d3a5044bb8d","IPY_MODEL_967d36d12d814dc780286691b53e5034"]}},"eb41ed4e01e84561b5db728ed9ac56c1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b001709b844b4b81a1f4ea1bcdab1e23":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_d365a8361b6a4ac3b9f2f8e46bc6fff1","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Downloading: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_945137d3150048028fcfd5cf9d1f7282"}},"ee89606ed52941c0bd088d3a5044bb8d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_9cdcf8647a234b53867f2c1cf2e90500","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":9081518,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":9081518,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a49f01848a5847c08296c5b4fff798df"}},"967d36d12d814dc780286691b53e5034":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_43545eccc1ac40a1a4b8e89e568ec42a","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 8.66M/8.66M [00:00&lt;00:00, 23.2MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c20ed80bfadc4a3a8f6e2b116f853518"}},"d365a8361b6a4ac3b9f2f8e46bc6fff1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"945137d3150048028fcfd5cf9d1f7282":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9cdcf8647a234b53867f2c1cf2e90500":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"a49f01848a5847c08296c5b4fff798df":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"43545eccc1ac40a1a4b8e89e568ec42a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"c20ed80bfadc4a3a8f6e2b116f853518":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"57b0629277614b5784e191b8af2c0b3d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_365b0678f20948da9b98d92520fd9660","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_8a01491891ff4685936bad5ffa25fbea","IPY_MODEL_580b683c1ade4ff998add8c9f56318a6","IPY_MODEL_d042afe153a548129c60db3cf03265c5"]}},"365b0678f20948da9b98d92520fd9660":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8a01491891ff4685936bad5ffa25fbea":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_131e5e6144624e7ab0a2f44059775b21","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Downloading: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_744a9b62e15a4ec095be8c457adc5a19"}},"580b683c1ade4ff998add8c9f56318a6":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_034ca75654e841cd934a6b4ebd3912fb","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":239,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":239,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b8d885d54205434fa99b26b931c39a16"}},"d042afe153a548129c60db3cf03265c5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_cb8bda5ebb6c48b5ba4129c714753e8e","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 239/239 [00:00&lt;00:00, 5.61kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_54cc419d273146c29702886406f30c8b"}},"131e5e6144624e7ab0a2f44059775b21":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"744a9b62e15a4ec095be8c457adc5a19":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"034ca75654e841cd934a6b4ebd3912fb":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"b8d885d54205434fa99b26b931c39a16":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"cb8bda5ebb6c48b5ba4129c714753e8e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"54cc419d273146c29702886406f30c8b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b866f623f10e42fe80035dccdb9c857b":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_6814c3e252db4bb9b3812ce708496dcd","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_6a75e2dc582344a78104cbb8712f040a","IPY_MODEL_c915d69d5df4473fb3d4d67cd84fed1d","IPY_MODEL_2ca13869ce62431da2687746cb3494d7"]}},"6814c3e252db4bb9b3812ce708496dcd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6a75e2dc582344a78104cbb8712f040a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_77fc342b9d69418f91ad8f76d1755412","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Downloading: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b250ea29b9cf4033bd277b6f9ddaa804"}},"c915d69d5df4473fb3d4d67cd84fed1d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_100756b9f90743258e81142b913b5423","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":470693617,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":470693617,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_44e0b0f449a44541b0a274eab92475fc"}},"2ca13869ce62431da2687746cb3494d7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_6e8c22eae0de4644a066f9435cd3a506","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 449M/449M [00:16&lt;00:00, 32.6MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_8524df5e70554885a02b2b066437c3a1"}},"77fc342b9d69418f91ad8f76d1755412":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"b250ea29b9cf4033bd277b6f9ddaa804":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"100756b9f90743258e81142b913b5423":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"44e0b0f449a44541b0a274eab92475fc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6e8c22eae0de4644a066f9435cd3a506":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"8524df5e70554885a02b2b066437c3a1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"87aae1f73307411a8971905db1890eaa":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_67f4f0677e444bf8a75ad95205aa2b23","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_503f810b92db4b38aa3438319bdaddb7","IPY_MODEL_573c5dba546140c0b4a80cc996cfb7b4","IPY_MODEL_357ddab51fab4b2cbb1ce15b39afc406"]}},"67f4f0677e444bf8a75ad95205aa2b23":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"503f810b92db4b38aa3438319bdaddb7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_2a5c60a2ceb34e92ab2fd2596d08e33d","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_265752da3d10444a9bbee6f9a7fa17c1"}},"573c5dba546140c0b4a80cc996cfb7b4":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_0ea943dd7c794a7c88de5da7e61dcce9","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":2964,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":2964,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_aefb68bd9d2b44aca197fae16b1047d5"}},"357ddab51fab4b2cbb1ce15b39afc406":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_df3bfc4ab77243958026e35cafee8d3e","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 2964/2964 [00:00&lt;00:00, 5503.62ex/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_75d118b099d24779aa3901be882f9de4"}},"2a5c60a2ceb34e92ab2fd2596d08e33d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"265752da3d10444a9bbee6f9a7fa17c1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0ea943dd7c794a7c88de5da7e61dcce9":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"aefb68bd9d2b44aca197fae16b1047d5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"df3bfc4ab77243958026e35cafee8d3e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"75d118b099d24779aa3901be882f9de4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"064fbb0f2802459db040917711b61464":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_bdb0eb5d55b5429e98eb554afe399719","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_cde54bce476e4044a03b655e7a5378ff","IPY_MODEL_63dbd0f0b4ac4a4eb09307f281e1fd8d","IPY_MODEL_f7ad5c67f3a64de6923c79151f23be09"]}},"bdb0eb5d55b5429e98eb554afe399719":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"cde54bce476e4044a03b655e7a5378ff":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_50c68c72104644008b6fe7f1041bb2a1","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_0f04fa16abb7406698caf8dd95dc5408"}},"63dbd0f0b4ac4a4eb09307f281e1fd8d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_6fdef826b2844025aca6fd2519af97e6","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":3,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":3,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_1e66821617a940949b345934184f0dec"}},"f7ad5c67f3a64de6923c79151f23be09":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_bd8d647ce290423695eab769a364ca7a","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 3/3 [00:00&lt;00:00, 17.35ba/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c5fefb84ff154a7baeb9d37d5020c82d"}},"50c68c72104644008b6fe7f1041bb2a1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"0f04fa16abb7406698caf8dd95dc5408":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6fdef826b2844025aca6fd2519af97e6":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"1e66821617a940949b345934184f0dec":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"bd8d647ce290423695eab769a364ca7a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"c5fefb84ff154a7baeb9d37d5020c82d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"709a59da787343318b8cbddffa414192":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_84816c7d874d48deadaa99a204eb4da4","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_a13df55cbb1240ac8b1f0df6efc61c8f","IPY_MODEL_664745bfc719469db327b30dc35d76c4","IPY_MODEL_b323fef1804443c5a14d7aa2ea14d3f7"]}},"84816c7d874d48deadaa99a204eb4da4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a13df55cbb1240ac8b1f0df6efc61c8f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_e9caf199a8d940fc938ff0b7e75a563c","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7d4c48902e0a4e40852fdf880de7bd81"}},"664745bfc719469db327b30dc35d76c4":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_265ef71dd02c4c0988ae8e5b32241da4","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":2175,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":2175,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_4be959a83f384c8a9d0e7831ea164156"}},"b323fef1804443c5a14d7aa2ea14d3f7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_56bc7e524d744cd0974b7ca3037b8fdb","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 2175/2175 [00:00&lt;00:00, 3970.76ex/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7abbab33a6444aca8973cc657cae4821"}},"e9caf199a8d940fc938ff0b7e75a563c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"7d4c48902e0a4e40852fdf880de7bd81":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"265ef71dd02c4c0988ae8e5b32241da4":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"4be959a83f384c8a9d0e7831ea164156":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"56bc7e524d744cd0974b7ca3037b8fdb":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"7abbab33a6444aca8973cc657cae4821":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ae17c6e8442440ba9aa1809d25eeec0f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_63890b46f8da496eaee63e45041f3ef3","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_48618877f69d4268b9fa4b8996e824f0","IPY_MODEL_ae6726c26e8f45cda22c30fb62b7892c","IPY_MODEL_55b69135a2934d3cb2b3e1441606a10e"]}},"63890b46f8da496eaee63e45041f3ef3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"48618877f69d4268b9fa4b8996e824f0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_fc539e5b90834f128352d65ed1eef734","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_e5335b64f9494f6c9f4580154fc185a9"}},"ae6726c26e8f45cda22c30fb62b7892c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_20ae1614bf5445a59c3beeb66b497d1e","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":500,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":500,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_06cb63ddb14c4f0b92910e6c4282c423"}},"55b69135a2934d3cb2b3e1441606a10e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_18812ed5717740d6be35a814128f370e","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 500/500 [00:33&lt;00:00, 14.41ex/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b6088ccc006345668c39c8cbd80b46fe"}},"fc539e5b90834f128352d65ed1eef734":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"e5335b64f9494f6c9f4580154fc185a9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"20ae1614bf5445a59c3beeb66b497d1e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"06cb63ddb14c4f0b92910e6c4282c423":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"18812ed5717740d6be35a814128f370e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"b6088ccc006345668c39c8cbd80b46fe":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"363d2b4e2eeb44938964bb6d4d7729eb":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_478ba08e72594a27ae5cc91ecef87b03","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_600b51e1fa9f4c4d9c6a952e7e85e63e","IPY_MODEL_6c7d4744c1bb4157a94111f290f9139e","IPY_MODEL_9be97f08433b4e21a14f64ea80a829e1"]}},"478ba08e72594a27ae5cc91ecef87b03":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"600b51e1fa9f4c4d9c6a952e7e85e63e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_cee71482dbdf494ead47dac7855cd387","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_506e08a549a84aee954bb1ec6a6de1ef"}},"6c7d4744c1bb4157a94111f290f9139e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_77bfe03564724e9ab2aac9f3d332c437","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_6fd9439633864ab29593e75131860218"}},"9be97f08433b4e21a14f64ea80a829e1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_99a84ef6528845bcbd49f7021268f66f","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1/1 [00:00&lt;00:00, 18.12it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b21fd6a9b82e42eaa0bc8c35597c816c"}},"cee71482dbdf494ead47dac7855cd387":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"506e08a549a84aee954bb1ec6a6de1ef":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"77bfe03564724e9ab2aac9f3d332c437":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"6fd9439633864ab29593e75131860218":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"99a84ef6528845bcbd49f7021268f66f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"b21fd6a9b82e42eaa0bc8c35597c816c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ONBnnThVopgw","executionInfo":{"status":"ok","timestamp":1637752179107,"user_tz":-60,"elapsed":12248,"user":{"displayName":"Frederik Niesner","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjS-rpAvcehenzUFe5XNA7F_HjIVdKRnRIwLRDH=s64","userId":"16681650301170974875"}},"outputId":"8f9a81be-a371-4569-f60e-14dd0e4fd3fe"},"source":["!pip install transformers\n","!pip install torch\n"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting transformers\n","  Downloading transformers-4.12.5-py3-none-any.whl (3.1 MB)\n","\u001b[K     |████████████████████████████████| 3.1 MB 5.3 MB/s \n","\u001b[?25hRequirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers) (2.23.0)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (1.19.5)\n","Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from transformers) (4.8.2)\n","Collecting sacremoses\n","  Downloading sacremoses-0.0.46-py3-none-any.whl (895 kB)\n","\u001b[K     |████████████████████████████████| 895 kB 38.2 MB/s \n","\u001b[?25hCollecting huggingface-hub<1.0,>=0.1.0\n","  Downloading huggingface_hub-0.1.2-py3-none-any.whl (59 kB)\n","\u001b[K     |████████████████████████████████| 59 kB 6.4 MB/s \n","\u001b[?25hRequirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.7/dist-packages (from transformers) (21.3)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers) (4.62.3)\n","Collecting tokenizers<0.11,>=0.10.1\n","  Downloading tokenizers-0.10.3-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (3.3 MB)\n","\u001b[K     |████████████████████████████████| 3.3 MB 36.5 MB/s \n","\u001b[?25hCollecting pyyaml>=5.1\n","  Downloading PyYAML-6.0-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (596 kB)\n","\u001b[K     |████████████████████████████████| 596 kB 46.2 MB/s \n","\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers) (3.4.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (2019.12.20)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0,>=0.1.0->transformers) (3.10.0.2)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=20.0->transformers) (3.0.6)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->transformers) (3.6.0)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2.10)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2021.10.8)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (3.0.4)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (1.24.3)\n","Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (1.15.0)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (1.1.0)\n","Requirement already satisfied: click in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (7.1.2)\n","Installing collected packages: pyyaml, tokenizers, sacremoses, huggingface-hub, transformers\n","  Attempting uninstall: pyyaml\n","    Found existing installation: PyYAML 3.13\n","    Uninstalling PyYAML-3.13:\n","      Successfully uninstalled PyYAML-3.13\n","Successfully installed huggingface-hub-0.1.2 pyyaml-6.0 sacremoses-0.0.46 tokenizers-0.10.3 transformers-4.12.5\n","Requirement already satisfied: torch in /usr/local/lib/python3.7/dist-packages (1.10.0+cu111)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from torch) (3.10.0.2)\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000,"referenced_widgets":["67517fa2e23d4ea8a0296a6db12f6bd7","0ca103ac85d6427fa88a6b08e6d8d1e1","575a11f2feec4dd683402516b7014ca8","275ed95102f4445383792a06ce4d608b","8fe91b39d5b6459f8695a7726a2df0d8","03f6432e215c46bc9c609ae5281c9e5b","ed1a4a4aa0104bf1a5400cab38cb8158","ebf928a1f911477bbd9ec6db0dbb95e2","3f9d9664cc5b485dbd2de305375f75d7","26ddb68eed5343c18c831fc7bbb8df86","c940bd8e9fc14db4b6befce11d825716","1b360db2e53046e39cc76f1c3a3eb05a","24e881730e67439796584e0bf708e91e","8d3db2da745e40b89a2806077e24f3bc","6d78efbefc13461ea3e50783d81aa3d4","acd5265dae0e4d638942a0a5b8976f98","9e61553db0794ca1b033815aa163731f","da3d0cd7a2c748079044025941bbc5d5","8a2fe804a96142558fd7bb50db10077e","84327822414749e088d08993042f9dc1","081c6d2b7d9448d098534ab2ae0b0eb6","69fb88125f9c438a97010cc5864220e4","0f1bb27453e54a958b4a65288c47b8a6","eb41ed4e01e84561b5db728ed9ac56c1","b001709b844b4b81a1f4ea1bcdab1e23","ee89606ed52941c0bd088d3a5044bb8d","967d36d12d814dc780286691b53e5034","d365a8361b6a4ac3b9f2f8e46bc6fff1","945137d3150048028fcfd5cf9d1f7282","9cdcf8647a234b53867f2c1cf2e90500","a49f01848a5847c08296c5b4fff798df","43545eccc1ac40a1a4b8e89e568ec42a","c20ed80bfadc4a3a8f6e2b116f853518","57b0629277614b5784e191b8af2c0b3d","365b0678f20948da9b98d92520fd9660","8a01491891ff4685936bad5ffa25fbea","580b683c1ade4ff998add8c9f56318a6","d042afe153a548129c60db3cf03265c5","131e5e6144624e7ab0a2f44059775b21","744a9b62e15a4ec095be8c457adc5a19","034ca75654e841cd934a6b4ebd3912fb","b8d885d54205434fa99b26b931c39a16","cb8bda5ebb6c48b5ba4129c714753e8e","54cc419d273146c29702886406f30c8b","b866f623f10e42fe80035dccdb9c857b","6814c3e252db4bb9b3812ce708496dcd","6a75e2dc582344a78104cbb8712f040a","c915d69d5df4473fb3d4d67cd84fed1d","2ca13869ce62431da2687746cb3494d7","77fc342b9d69418f91ad8f76d1755412","b250ea29b9cf4033bd277b6f9ddaa804","100756b9f90743258e81142b913b5423","44e0b0f449a44541b0a274eab92475fc","6e8c22eae0de4644a066f9435cd3a506","8524df5e70554885a02b2b066437c3a1"]},"id":"7zygju58okpj","executionInfo":{"status":"ok","timestamp":1637752215920,"user_tz":-60,"elapsed":30312,"user":{"displayName":"Frederik Niesner","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjS-rpAvcehenzUFe5XNA7F_HjIVdKRnRIwLRDH=s64","userId":"16681650301170974875"}},"outputId":"14cbd750-412a-44d7-8a04-0423f2e3d975"},"source":["from transformers import AutoTokenizer, AutoModel\n","import torch\n","\n","\n","#Mean Pooling - Take attention mask into account for correct averaging\n","def mean_pooling(model_output, attention_mask):\n","    token_embeddings = model_output[0] #First element of model_output contains all token embeddings\n","    input_mask_expanded = attention_mask.unsqueeze(-1).expand(token_embeddings.size()).float()\n","    return torch.sum(token_embeddings * input_mask_expanded, 1) / torch.clamp(input_mask_expanded.sum(1), min=1e-9)\n","\n","\n","# Sentences we want sentence embeddings for\n","sentences = ['This is an example sentence', 'Each sentence is converted']\n","\n","# Load model from HuggingFace Hub\n","tokenizer = AutoTokenizer.from_pretrained('sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2')\n","model = AutoModel.from_pretrained('sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2')\n","\n","# Tokenize sentences\n","encoded_input = tokenizer(sentences, padding=True, truncation=True, return_tensors='pt')\n","\n","# Compute token embeddings\n","with torch.no_grad():\n","    model_output = model(**encoded_input)\n","\n","# Perform pooling. In this case, max pooling.\n","sentence_embeddings = mean_pooling(model_output, encoded_input['attention_mask'])\n","\n","print(\"Sentence embeddings:\")\n","print(sentence_embeddings)"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"67517fa2e23d4ea8a0296a6db12f6bd7","version_minor":0,"version_major":2},"text/plain":["Downloading:   0%|          | 0.00/480 [00:00<?, ?B/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"1b360db2e53046e39cc76f1c3a3eb05a","version_minor":0,"version_major":2},"text/plain":["Downloading:   0%|          | 0.00/645 [00:00<?, ?B/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"0f1bb27453e54a958b4a65288c47b8a6","version_minor":0,"version_major":2},"text/plain":["Downloading:   0%|          | 0.00/8.66M [00:00<?, ?B/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"57b0629277614b5784e191b8af2c0b3d","version_minor":0,"version_major":2},"text/plain":["Downloading:   0%|          | 0.00/239 [00:00<?, ?B/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"b866f623f10e42fe80035dccdb9c857b","version_minor":0,"version_major":2},"text/plain":["Downloading:   0%|          | 0.00/449M [00:00<?, ?B/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Sentence embeddings:\n","tensor([[ 0.1885,  0.1743,  0.0545,  0.2905,  0.1677, -0.0472,  0.6456,  0.1598,\n","          0.2269, -0.0309,  0.2559, -0.0526, -0.2261, -0.0571,  0.1304,  0.1250,\n","          0.3175,  0.1944, -0.5863, -0.0126,  0.6099,  0.1643,  0.0333, -0.2738,\n","         -0.2898, -0.2112, -0.0226, -0.1704,  0.1616,  0.0608, -0.2416,  0.1858,\n","          0.4274,  0.1930, -0.0723,  0.1661,  0.1044,  0.2048,  0.2112,  0.1997,\n","         -0.0941, -0.1738,  0.0643,  0.2803, -0.2953,  0.0621,  0.1043, -0.0236,\n","          0.1291, -0.1262, -0.1790,  0.0370, -0.6125,  0.0503,  0.1773,  0.2249,\n","          0.1739, -0.0384, -0.2129,  0.2585, -0.1210,  0.3097, -0.4197,  0.0091,\n","          0.1419, -0.3056,  0.1762, -0.0709, -0.6203,  0.6771,  0.0172,  0.1841,\n","         -0.1679,  0.2045, -0.1477, -0.0618,  0.6302,  0.1112,  0.0515,  0.1593,\n","         -0.0537,  0.0535,  0.1414,  0.1124, -0.4841, -0.1699, -0.0532,  0.2765,\n","          0.1178, -0.3491, -0.5138, -0.3284,  0.5424, -0.0533,  0.2292, -0.0128,\n","          0.1033, -0.3363,  0.2476,  0.8155, -0.0893,  0.2476, -0.1204,  0.0190,\n","          0.3246, -0.2616, -0.1971,  0.0144, -0.0356, -0.3274, -0.0483,  0.1803,\n","          0.0231, -0.1425, -0.1952, -0.5549,  0.0415, -0.0804, -0.1291,  0.3454,\n","          0.0418, -0.1779,  0.3446,  0.1076,  0.0064, -0.8082,  0.1831, -0.0612,\n","          0.1028, -0.3596, -0.1210, -0.3191,  0.1443,  0.1977, -0.0476, -0.1363,\n","          0.2792,  0.1077, -0.0340,  0.0656,  0.0339,  0.4743,  0.0320,  0.4382,\n","         -0.1888,  0.3911, -0.2936, -0.0902, -0.0819,  0.1529,  0.1181, -0.2979,\n","          0.1829, -0.2352, -0.0434, -0.0831, -0.0145,  0.0894,  0.1175, -0.0631,\n","         -0.1307,  0.1605, -0.0799,  0.0452, -0.1164, -0.1961,  0.0394, -0.3491,\n","         -0.0115,  0.2609,  0.3166, -0.0806, -0.1807,  0.0202, -0.0884, -0.0168,\n","         -0.3813,  0.1545, -0.0323,  0.0139,  0.3147, -0.2919, -0.1179, -0.0233,\n","         -0.2291,  0.2485, -0.0826,  0.1752,  0.0705,  0.1789, -0.1975,  0.1159,\n","          0.2296,  0.0884, -0.3414, -0.0031,  0.4404,  0.2077, -0.2384,  0.1455,\n","         -0.3251, -0.0497,  0.0841, -0.2610,  0.4221, -0.2734,  0.2296, -0.1896,\n","         -0.1734, -0.0464,  0.1255,  0.4785, -0.5530,  0.2156,  0.0697,  0.0728,\n","         -0.2389,  0.1989, -0.4235, -0.1645, -0.2276, -0.0492,  0.2374, -0.4553,\n","         -0.0625,  0.5811, -0.0889, -0.0540,  0.2866, -0.4812, -0.0612, -0.2812,\n","          0.3690, -0.2953, -0.7187, -0.3877, -0.1632,  0.1390, -0.0209, -0.0523,\n","         -0.1061, -0.0553, -0.0638,  0.0299,  0.0134,  0.0126,  0.1107, -0.0700,\n","         -0.0171,  0.1081, -0.1113, -0.4287, -0.3334,  0.1457, -0.2426,  0.1518,\n","         -0.0818,  0.2434, -0.3775,  0.0815,  0.0922, -0.2765,  0.0406,  0.2000,\n","         -0.0478, -0.4051,  0.1809,  0.0808,  0.0278,  0.1498, -0.4525, -0.0611,\n","          0.2271, -0.1310, -0.2985, -0.1530, -0.2612, -0.2219,  0.0427, -0.2006,\n","         -0.0220, -0.4944,  0.5353, -0.0298, -0.0196,  0.0571,  0.1787,  0.3116,\n","          0.3637,  0.2113, -0.3937,  0.1749,  0.0114, -0.1050, -0.1438, -0.1066,\n","         -0.4386,  0.0465, -0.2690, -0.0321,  0.3127, -0.2875, -0.3052, -0.0265,\n","          0.2525, -0.1886,  0.2102,  0.0765, -0.3166,  0.1316, -0.0285,  0.2662,\n","         -0.4398,  0.3357, -0.0206, -0.2281, -0.1840,  0.1513, -0.2093, -0.4557,\n","          0.0974, -0.1739, -0.1294, -0.1156,  0.2791, -0.1525,  0.1635, -0.1845,\n","         -0.0057, -0.3015, -0.1003,  0.3360, -0.0110,  0.0147, -0.0763,  0.7871,\n","         -0.2812, -0.2382,  0.1006,  0.5990,  0.5007,  0.1582, -0.2904,  0.0654,\n","         -0.1489,  0.0684, -0.0396,  0.1465, -0.1463,  0.1791,  0.2805,  0.3625,\n","         -0.3134, -0.0409, -0.0765,  0.1532,  0.1926, -0.3737,  0.0954, -0.2840,\n","         -0.0015, -0.0493,  0.4472,  0.6577,  0.1652,  0.0587, -0.4044, -0.0780,\n","         -0.2554, -0.3610, -0.0968, -0.1421,  0.1475,  0.0952,  0.0568, -0.1748,\n","          0.2615,  0.1411,  0.1246,  0.0886,  0.1845,  0.2709,  0.3477,  0.0873],\n","        [ 0.3471,  0.1798,  0.1129, -0.2238, -0.0294,  0.0087,  0.5689, -0.1742,\n","          0.1557,  0.0592,  0.0477,  0.1191,  0.0696, -0.3916, -0.1165,  0.3968,\n","         -0.1670,  0.4225, -0.6076, -0.2321,  0.0648,  0.1662, -0.2338, -0.1162,\n","          0.0902,  0.3396, -0.1662, -0.2978, -0.0145, -0.3106, -0.0296,  0.4453,\n","          0.4452, -0.0163, -0.1281,  0.2956, -0.4481,  0.3888,  0.1651,  0.1234,\n","         -0.3239, -0.0844,  0.1781,  0.0518,  0.3128,  0.0646, -0.3461, -0.0101,\n","         -0.0788,  0.3103, -0.1087,  0.0718, -0.4850,  0.5769,  0.1336,  0.0263,\n","         -0.2510,  0.3712, -0.1070, -0.1775, -0.0954,  0.1827, -0.5296,  0.2284,\n","         -0.0298, -0.1333,  0.3541, -0.0083, -0.2498,  0.5316, -0.1718,  0.0951,\n","          0.2792, -0.3649, -0.1571,  0.2887,  0.2030,  0.0597,  0.1313,  0.0566,\n","         -0.0622,  0.2147,  0.1161, -0.3991,  0.1195, -0.2489, -0.1326,  0.4465,\n","          0.3126, -0.3931, -0.1713, -0.5402,  0.7123,  0.0804,  0.1706, -0.0695,\n","         -0.1823, -0.3725,  0.5620,  0.3643, -0.0876,  0.5458, -0.0370, -0.0589,\n","         -0.2608, -0.2623, -0.0794,  0.3217,  0.1470, -0.1856, -0.3207,  0.2324,\n","          0.3021, -0.0860,  0.0082, -0.1506,  0.2707, -0.3317,  0.0081,  0.7361,\n","         -0.0107,  0.0953,  0.0312,  0.1678, -0.0947, -0.3278,  0.1582, -0.1108,\n","         -0.0753, -0.2856,  0.0881,  0.1267, -0.0542,  0.1383, -0.1738, -0.1796,\n","          0.1591, -0.1325, -0.0250, -0.0286,  0.2215,  0.4124, -0.1000,  0.3917,\n","         -0.0302,  0.1966, -0.5090, -0.1326, -0.0818,  0.3130, -0.2441, -0.1558,\n","         -0.2763, -0.2603,  0.0261,  0.1595, -0.0237, -0.0571, -0.2129,  0.0817,\n","         -0.0817,  0.1913, -0.2987,  0.1933,  0.2629,  0.0781,  0.0893,  0.1818,\n","         -0.2414, -0.0013,  0.5129, -0.2490, -0.2828, -0.3294, -0.2773,  0.3001,\n","         -0.1064,  0.1498,  0.2015,  0.1460,  0.0816, -0.1515, -0.3677,  0.2851,\n","         -0.2010,  0.0408, -0.4555,  0.0834, -0.0736,  0.2959,  0.0557, -0.3490,\n","          0.0990, -0.0179, -0.2533, -0.0593,  0.2137,  0.2109, -0.5561,  0.1241,\n","          0.0470,  0.0611, -0.0019, -0.4776,  0.1824,  0.0741, -0.3927, -0.1748,\n","         -0.0665,  0.2893, -0.0072,  0.1300,  0.3454,  0.0055,  0.2757,  0.0720,\n","         -0.0056, -0.2227,  0.0263, -0.3982,  0.1664, -0.3863,  0.3628, -0.2136,\n","         -0.2124,  0.6678, -0.1967,  0.3209, -0.1752, -0.3112, -0.2694, -0.0679,\n","          0.0513, -0.4331, -0.0684, -0.2516, -0.2388,  0.0497, -0.1801,  0.0288,\n","          0.1089,  0.3993,  0.0103,  0.0465,  0.0443,  0.1872, -0.0643,  0.0536,\n","         -0.1559, -0.1005,  0.2933, -0.0484,  0.0230,  0.3100, -0.0625,  0.0295,\n","         -0.3295,  0.5130, -0.3465, -0.1915,  0.2619, -0.0251, -0.1012,  0.6904,\n","          0.2868, -0.4248, -0.3400, -0.0238,  0.0367, -0.2146, -0.3136,  0.0668,\n","         -0.0655, -0.1464,  0.1819, -0.1591, -0.4985, -0.2117,  0.1163, -0.2699,\n","          0.1627, -0.6432,  0.3200,  0.0848, -0.0083,  0.1347,  0.2040, -0.0488,\n","          0.2293,  0.1296, -0.2885, -0.0184,  0.1664, -0.2572, -0.1895,  0.2668,\n","         -0.5341,  0.0330, -0.1601, -0.3483, -0.1348, -0.0790, -0.4004,  0.2391,\n","         -0.1894, -0.2300, -0.2650,  0.3055, -0.2158,  0.1284,  0.2207,  0.0247,\n","         -0.3739,  0.3478, -0.1609, -0.0352,  0.1971,  0.0514, -0.2449,  0.0464,\n","          0.1060, -0.0390, -0.3935,  0.3539,  0.2617, -0.2031,  0.0671, -0.2901,\n","          0.2156, -0.1134, -0.1133,  0.5839, -0.3626,  0.0955, -0.1885,  0.5221,\n","          0.0105,  0.0886, -0.1968,  0.5223,  0.5878,  0.0796, -0.1802, -0.0291,\n","         -0.1164,  0.3380,  0.1357,  0.0103, -0.4084, -0.1748,  0.1240,  0.1242,\n","         -0.2175,  0.2691, -0.1052, -0.0616,  0.4626, -0.1541,  0.2371,  0.1853,\n","          0.0955, -0.4005,  0.0372,  0.2866, -0.2981, -0.2248, -0.1374, -0.2156,\n","         -0.0223, -0.2234, -0.2123,  0.1121,  0.0611, -0.2771,  0.2833, -0.2534,\n","          0.6110,  0.3497,  0.2769,  0.1730, -0.1856,  0.3127,  0.0295, -0.2770]])\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"U9aY7iCrvEAg","executionInfo":{"status":"ok","timestamp":1637753839258,"user_tz":-60,"elapsed":213,"user":{"displayName":"Frederik Niesner","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjS-rpAvcehenzUFe5XNA7F_HjIVdKRnRIwLRDH=s64","userId":"16681650301170974875"}},"outputId":"2d667d90-ce31-4548-d1d4-e322f163c74c"},"source":["print(f'Shape of the vectorised abstract: {sentence_embeddings[0].shape}')"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Shape of the vectorised abstract: torch.Size([384])\n"]}]},{"cell_type":"code","metadata":{"id":"GlSmTxp2vS90"},"source":["import numpy as np\n","import faiss"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":403},"id":"SQFlpgnKBg0I","executionInfo":{"status":"ok","timestamp":1637323971800,"user_tz":-60,"elapsed":9,"user":{"displayName":"Frederik Niesner","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjS-rpAvcehenzUFe5XNA7F_HjIVdKRnRIwLRDH=s64","userId":"16681650301170974875"}},"outputId":"86400017-7719-4d88-f970-20f25bea0711"},"source":["comments_df = df.explode(\"comments\", ignore_index=True)\n","comments_df.head(4)\n"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>html_url</th>\n","      <th>title</th>\n","      <th>comments</th>\n","      <th>body</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>https://github.com/huggingface/datasets/issues...</td>\n","      <td>Protect master branch</td>\n","      <td>Cool, I think we can do both :)</td>\n","      <td>After accidental merge commit (91c55355b634d0d...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>https://github.com/huggingface/datasets/issues...</td>\n","      <td>Protect master branch</td>\n","      <td>@lhoestq now the 2 are implemented.\\r\\n\\r\\nPle...</td>\n","      <td>After accidental merge commit (91c55355b634d0d...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>https://github.com/huggingface/datasets/issues...</td>\n","      <td>Backwards compatibility broken for cached data...</td>\n","      <td>Hi ! I guess the caching mechanism should have...</td>\n","      <td>## Describe the bug\\r\\nAfter upgrading to data...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>https://github.com/huggingface/datasets/issues...</td>\n","      <td>Backwards compatibility broken for cached data...</td>\n","      <td>If it's easy enough to implement, then yes ple...</td>\n","      <td>## Describe the bug\\r\\nAfter upgrading to data...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                                            html_url  ...                                               body\n","0  https://github.com/huggingface/datasets/issues...  ...  After accidental merge commit (91c55355b634d0d...\n","1  https://github.com/huggingface/datasets/issues...  ...  After accidental merge commit (91c55355b634d0d...\n","2  https://github.com/huggingface/datasets/issues...  ...  ## Describe the bug\\r\\nAfter upgrading to data...\n","3  https://github.com/huggingface/datasets/issues...  ...  ## Describe the bug\\r\\nAfter upgrading to data...\n","\n","[4 rows x 4 columns]"]},"metadata":{},"execution_count":8}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"uIugoRWqzg21","executionInfo":{"status":"ok","timestamp":1637755014839,"user_tz":-60,"elapsed":8542,"user":{"displayName":"Frederik Niesner","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjS-rpAvcehenzUFe5XNA7F_HjIVdKRnRIwLRDH=s64","userId":"16681650301170974875"}},"outputId":"69bf5f53-bfa5-4077-efe4-fe3ed04ba368"},"source":["!pip install datasets"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting datasets\n","  Downloading datasets-1.15.1-py3-none-any.whl (290 kB)\n","\u001b[K     |████████████████████████████████| 290 kB 5.3 MB/s \n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from datasets) (1.19.5)\n","Requirement already satisfied: dill in /usr/local/lib/python3.7/dist-packages (from datasets) (0.3.4)\n","Requirement already satisfied: tqdm>=4.62.1 in /usr/local/lib/python3.7/dist-packages (from datasets) (4.62.3)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.7/dist-packages (from datasets) (1.1.5)\n","Requirement already satisfied: huggingface-hub<1.0.0,>=0.1.0 in /usr/local/lib/python3.7/dist-packages (from datasets) (0.1.2)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from datasets) (21.3)\n","Collecting fsspec[http]>=2021.05.0\n","  Downloading fsspec-2021.11.0-py3-none-any.whl (132 kB)\n","\u001b[K     |████████████████████████████████| 132 kB 45.1 MB/s \n","\u001b[?25hRequirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from datasets) (4.8.2)\n","Requirement already satisfied: pyarrow!=4.0.0,>=1.0.0 in /usr/local/lib/python3.7/dist-packages (from datasets) (3.0.0)\n","Requirement already satisfied: multiprocess in /usr/local/lib/python3.7/dist-packages (from datasets) (0.70.12.2)\n","Collecting aiohttp\n","  Downloading aiohttp-3.8.1-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (1.1 MB)\n","\u001b[K     |████████████████████████████████| 1.1 MB 37.2 MB/s \n","\u001b[?25hRequirement already satisfied: requests>=2.19.0 in /usr/local/lib/python3.7/dist-packages (from datasets) (2.23.0)\n","Collecting xxhash\n","  Downloading xxhash-2.0.2-cp37-cp37m-manylinux2010_x86_64.whl (243 kB)\n","\u001b[K     |████████████████████████████████| 243 kB 47.8 MB/s \n","\u001b[?25hRequirement already satisfied: pyyaml in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0.0,>=0.1.0->datasets) (6.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0.0,>=0.1.0->datasets) (3.10.0.2)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0.0,>=0.1.0->datasets) (3.4.0)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging->datasets) (3.0.6)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests>=2.19.0->datasets) (2.10)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests>=2.19.0->datasets) (1.24.3)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests>=2.19.0->datasets) (2021.10.8)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests>=2.19.0->datasets) (3.0.4)\n","Collecting aiosignal>=1.1.2\n","  Downloading aiosignal-1.2.0-py3-none-any.whl (8.2 kB)\n","Collecting frozenlist>=1.1.1\n","  Downloading frozenlist-1.2.0-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (192 kB)\n","\u001b[K     |████████████████████████████████| 192 kB 48.6 MB/s \n","\u001b[?25hCollecting async-timeout<5.0,>=4.0.0a3\n","  Downloading async_timeout-4.0.1-py3-none-any.whl (5.7 kB)\n","Collecting yarl<2.0,>=1.0\n","  Downloading yarl-1.7.2-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (271 kB)\n","\u001b[K     |████████████████████████████████| 271 kB 47.4 MB/s \n","\u001b[?25hRequirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.7/dist-packages (from aiohttp->datasets) (21.2.0)\n","Requirement already satisfied: charset-normalizer<3.0,>=2.0 in /usr/local/lib/python3.7/dist-packages (from aiohttp->datasets) (2.0.7)\n","Collecting multidict<7.0,>=4.5\n","  Downloading multidict-5.2.0-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (160 kB)\n","\u001b[K     |████████████████████████████████| 160 kB 47.2 MB/s \n","\u001b[?25hCollecting asynctest==0.13.0\n","  Downloading asynctest-0.13.0-py3-none-any.whl (26 kB)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->datasets) (3.6.0)\n","Requirement already satisfied: pytz>=2017.2 in /usr/local/lib/python3.7/dist-packages (from pandas->datasets) (2018.9)\n","Requirement already satisfied: python-dateutil>=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas->datasets) (2.8.2)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil>=2.7.3->pandas->datasets) (1.15.0)\n","Installing collected packages: multidict, frozenlist, yarl, asynctest, async-timeout, aiosignal, fsspec, aiohttp, xxhash, datasets\n","Successfully installed aiohttp-3.8.1 aiosignal-1.2.0 async-timeout-4.0.1 asynctest-0.13.0 datasets-1.15.1 frozenlist-1.2.0 fsspec-2021.11.0 multidict-5.2.0 xxhash-2.0.2 yarl-1.7.2\n"]}]},{"cell_type":"code","metadata":{"id":"CURA49ZRBkBz"},"source":["from datasets import Dataset\n","\n","# comments_dataset = Dataset.from_pandas(comments_df)\n","# comments_dataset"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49,"referenced_widgets":["87aae1f73307411a8971905db1890eaa","67f4f0677e444bf8a75ad95205aa2b23","503f810b92db4b38aa3438319bdaddb7","573c5dba546140c0b4a80cc996cfb7b4","357ddab51fab4b2cbb1ce15b39afc406","2a5c60a2ceb34e92ab2fd2596d08e33d","265752da3d10444a9bbee6f9a7fa17c1","0ea943dd7c794a7c88de5da7e61dcce9","aefb68bd9d2b44aca197fae16b1047d5","df3bfc4ab77243958026e35cafee8d3e","75d118b099d24779aa3901be882f9de4"]},"id":"-bcT-AbVBl2t","executionInfo":{"status":"ok","timestamp":1637323972449,"user_tz":-60,"elapsed":655,"user":{"displayName":"Frederik Niesner","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjS-rpAvcehenzUFe5XNA7F_HjIVdKRnRIwLRDH=s64","userId":"16681650301170974875"}},"outputId":"cc442dcf-2db1-40f1-c5b5-50a1b8d73bd7"},"source":["comments_dataset = comments_dataset.map(\n","    lambda x: {\"comment_length\": len(x[\"comments\"].split())}\n",")"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"87aae1f73307411a8971905db1890eaa","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/2964 [00:00<?, ?ex/s]"]},"metadata":{}}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":118,"referenced_widgets":["064fbb0f2802459db040917711b61464","bdb0eb5d55b5429e98eb554afe399719","cde54bce476e4044a03b655e7a5378ff","63dbd0f0b4ac4a4eb09307f281e1fd8d","f7ad5c67f3a64de6923c79151f23be09","50c68c72104644008b6fe7f1041bb2a1","0f04fa16abb7406698caf8dd95dc5408","6fdef826b2844025aca6fd2519af97e6","1e66821617a940949b345934184f0dec","bd8d647ce290423695eab769a364ca7a","c5fefb84ff154a7baeb9d37d5020c82d"]},"id":"ywShppZNBn77","executionInfo":{"status":"ok","timestamp":1637323972449,"user_tz":-60,"elapsed":8,"user":{"displayName":"Frederik Niesner","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjS-rpAvcehenzUFe5XNA7F_HjIVdKRnRIwLRDH=s64","userId":"16681650301170974875"}},"outputId":"226dda50-f89a-47b3-a350-8daa744da241"},"source":["comments_dataset = comments_dataset.filter(lambda x: x[\"comment_length\"] > 15)\n","comments_dataset\n"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"064fbb0f2802459db040917711b61464","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/3 [00:00<?, ?ba/s]"]},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["Dataset({\n","    features: ['html_url', 'title', 'comments', 'body', 'comment_length'],\n","    num_rows: 2175\n","})"]},"metadata":{},"execution_count":11}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49,"referenced_widgets":["709a59da787343318b8cbddffa414192","84816c7d874d48deadaa99a204eb4da4","a13df55cbb1240ac8b1f0df6efc61c8f","664745bfc719469db327b30dc35d76c4","b323fef1804443c5a14d7aa2ea14d3f7","e9caf199a8d940fc938ff0b7e75a563c","7d4c48902e0a4e40852fdf880de7bd81","265ef71dd02c4c0988ae8e5b32241da4","4be959a83f384c8a9d0e7831ea164156","56bc7e524d744cd0974b7ca3037b8fdb","7abbab33a6444aca8973cc657cae4821"]},"id":"4aPYMmyqBpHW","executionInfo":{"status":"ok","timestamp":1637323973078,"user_tz":-60,"elapsed":633,"user":{"displayName":"Frederik Niesner","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjS-rpAvcehenzUFe5XNA7F_HjIVdKRnRIwLRDH=s64","userId":"16681650301170974875"}},"outputId":"b15d67ba-6ad7-4e29-b883-87cccc6e38ac"},"source":["def concatenate_text(examples):\n","    return {\n","        \"text\": examples[\"title\"]\n","        + \" \\n \"\n","        + examples[\"body\"]\n","        + \" \\n \"\n","        + examples[\"comments\"]\n","    }\n","\n","\n","comments_dataset = comments_dataset.map(concatenate_text)"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"709a59da787343318b8cbddffa414192","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/2175 [00:00<?, ?ex/s]"]},"metadata":{}}]},{"cell_type":"code","metadata":{"id":"rQ6sV5FyyTsT"},"source":["import pandas as pd\n"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"kxeI2hu_yPQ9"},"source":["df = pd.read_csv(\"/content/drive/MyDrive/Code/Repositories/transformer_language_models/semanticSearch/sample-data.csv\")\n","df = Dataset.from_pandas(df)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":166},"id":"rSp21iurykVx","executionInfo":{"status":"error","timestamp":1637755043777,"user_tz":-60,"elapsed":210,"user":{"displayName":"Frederik Niesner","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjS-rpAvcehenzUFe5XNA7F_HjIVdKRnRIwLRDH=s64","userId":"16681650301170974875"}},"outputId":"1a800e5e-bb81-45b0-95bb-349df9678e17"},"source":[""],"execution_count":null,"outputs":[{"output_type":"error","ename":"AttributeError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)","\u001b[0;32m<ipython-input-30-c42a15b2c7cf>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mdf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mhead\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;31mAttributeError\u001b[0m: 'Dataset' object has no attribute 'head'"]}]},{"cell_type":"code","metadata":{"id":"8-WB0O6EBsEq"},"source":["from transformers import AutoTokenizer, AutoModel\n","\n","model_ckpt = \"sentence-transformers/multi-qa-mpnet-base-dot-v1\"\n","tokenizer = AutoTokenizer.from_pretrained(model_ckpt)\n","model = AutoModel.from_pretrained(model_ckpt)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"t7sEg6lVBt8N","executionInfo":{"status":"ok","timestamp":1637754787755,"user_tz":-60,"elapsed":12135,"user":{"displayName":"Frederik Niesner","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjS-rpAvcehenzUFe5XNA7F_HjIVdKRnRIwLRDH=s64","userId":"16681650301170974875"}},"outputId":"6390235a-407d-4f3f-9500-d329fccaf85f"},"source":["import torch\n","\n","device = torch.device(\"cuda\")\n","model.to(device)"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["MPNetModel(\n","  (embeddings): MPNetEmbeddings(\n","    (word_embeddings): Embedding(30527, 768, padding_idx=1)\n","    (position_embeddings): Embedding(514, 768, padding_idx=1)\n","    (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","    (dropout): Dropout(p=0.1, inplace=False)\n","  )\n","  (encoder): MPNetEncoder(\n","    (layer): ModuleList(\n","      (0): MPNetLayer(\n","        (attention): MPNetAttention(\n","          (attn): MPNetSelfAttention(\n","            (q): Linear(in_features=768, out_features=768, bias=True)\n","            (k): Linear(in_features=768, out_features=768, bias=True)\n","            (v): Linear(in_features=768, out_features=768, bias=True)\n","            (o): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","        (intermediate): MPNetIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): MPNetOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","      )\n","      (1): MPNetLayer(\n","        (attention): MPNetAttention(\n","          (attn): MPNetSelfAttention(\n","            (q): Linear(in_features=768, out_features=768, bias=True)\n","            (k): Linear(in_features=768, out_features=768, bias=True)\n","            (v): Linear(in_features=768, out_features=768, bias=True)\n","            (o): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","        (intermediate): MPNetIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): MPNetOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","      )\n","      (2): MPNetLayer(\n","        (attention): MPNetAttention(\n","          (attn): MPNetSelfAttention(\n","            (q): Linear(in_features=768, out_features=768, bias=True)\n","            (k): Linear(in_features=768, out_features=768, bias=True)\n","            (v): Linear(in_features=768, out_features=768, bias=True)\n","            (o): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","        (intermediate): MPNetIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): MPNetOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","      )\n","      (3): MPNetLayer(\n","        (attention): MPNetAttention(\n","          (attn): MPNetSelfAttention(\n","            (q): Linear(in_features=768, out_features=768, bias=True)\n","            (k): Linear(in_features=768, out_features=768, bias=True)\n","            (v): Linear(in_features=768, out_features=768, bias=True)\n","            (o): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","        (intermediate): MPNetIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): MPNetOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","      )\n","      (4): MPNetLayer(\n","        (attention): MPNetAttention(\n","          (attn): MPNetSelfAttention(\n","            (q): Linear(in_features=768, out_features=768, bias=True)\n","            (k): Linear(in_features=768, out_features=768, bias=True)\n","            (v): Linear(in_features=768, out_features=768, bias=True)\n","            (o): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","        (intermediate): MPNetIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): MPNetOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","      )\n","      (5): MPNetLayer(\n","        (attention): MPNetAttention(\n","          (attn): MPNetSelfAttention(\n","            (q): Linear(in_features=768, out_features=768, bias=True)\n","            (k): Linear(in_features=768, out_features=768, bias=True)\n","            (v): Linear(in_features=768, out_features=768, bias=True)\n","            (o): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","        (intermediate): MPNetIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): MPNetOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","      )\n","      (6): MPNetLayer(\n","        (attention): MPNetAttention(\n","          (attn): MPNetSelfAttention(\n","            (q): Linear(in_features=768, out_features=768, bias=True)\n","            (k): Linear(in_features=768, out_features=768, bias=True)\n","            (v): Linear(in_features=768, out_features=768, bias=True)\n","            (o): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","        (intermediate): MPNetIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): MPNetOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","      )\n","      (7): MPNetLayer(\n","        (attention): MPNetAttention(\n","          (attn): MPNetSelfAttention(\n","            (q): Linear(in_features=768, out_features=768, bias=True)\n","            (k): Linear(in_features=768, out_features=768, bias=True)\n","            (v): Linear(in_features=768, out_features=768, bias=True)\n","            (o): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","        (intermediate): MPNetIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): MPNetOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","      )\n","      (8): MPNetLayer(\n","        (attention): MPNetAttention(\n","          (attn): MPNetSelfAttention(\n","            (q): Linear(in_features=768, out_features=768, bias=True)\n","            (k): Linear(in_features=768, out_features=768, bias=True)\n","            (v): Linear(in_features=768, out_features=768, bias=True)\n","            (o): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","        (intermediate): MPNetIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): MPNetOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","      )\n","      (9): MPNetLayer(\n","        (attention): MPNetAttention(\n","          (attn): MPNetSelfAttention(\n","            (q): Linear(in_features=768, out_features=768, bias=True)\n","            (k): Linear(in_features=768, out_features=768, bias=True)\n","            (v): Linear(in_features=768, out_features=768, bias=True)\n","            (o): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","        (intermediate): MPNetIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): MPNetOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","      )\n","      (10): MPNetLayer(\n","        (attention): MPNetAttention(\n","          (attn): MPNetSelfAttention(\n","            (q): Linear(in_features=768, out_features=768, bias=True)\n","            (k): Linear(in_features=768, out_features=768, bias=True)\n","            (v): Linear(in_features=768, out_features=768, bias=True)\n","            (o): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","        (intermediate): MPNetIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): MPNetOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","      )\n","      (11): MPNetLayer(\n","        (attention): MPNetAttention(\n","          (attn): MPNetSelfAttention(\n","            (q): Linear(in_features=768, out_features=768, bias=True)\n","            (k): Linear(in_features=768, out_features=768, bias=True)\n","            (v): Linear(in_features=768, out_features=768, bias=True)\n","            (o): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","        (intermediate): MPNetIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): MPNetOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","      )\n","    )\n","    (relative_attention_bias): Embedding(32, 12)\n","  )\n","  (pooler): MPNetPooler(\n","    (dense): Linear(in_features=768, out_features=768, bias=True)\n","    (activation): Tanh()\n","  )\n",")"]},"metadata":{},"execution_count":18}]},{"cell_type":"code","metadata":{"id":"U6gqiS2FBvW5"},"source":["def cls_pooling(model_output):\n","    return model_output.last_hidden_state[:, 0]\n"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"3j6qfLo7C9KN"},"source":["def get_embeddings(text_list):\n","    encoded_input = tokenizer(\n","        text_list, padding=True, truncation=True, return_tensors=\"pt\"\n","    )\n","    encoded_input = {k: v.to(device) for k, v in encoded_input.items()}\n","    model_output = model(**encoded_input)\n","    return cls_pooling(model_output)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"aBbG5b_QC9IH","executionInfo":{"status":"ok","timestamp":1637755060241,"user_tz":-60,"elapsed":210,"user":{"displayName":"Frederik Niesner","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjS-rpAvcehenzUFe5XNA7F_HjIVdKRnRIwLRDH=s64","userId":"16681650301170974875"}},"outputId":"e1dfed71-24e8-4f7d-e47a-4cda4360c805"},"source":["# embedding = get_embeddings(comments_dataset[\"text\"][0])\n","# embedding.shape\n","embedding = get_embeddings(df[\"description\"][0])\n","embedding.shape"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([1, 768])"]},"metadata":{},"execution_count":31}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":67,"referenced_widgets":["ae17c6e8442440ba9aa1809d25eeec0f","63890b46f8da496eaee63e45041f3ef3","48618877f69d4268b9fa4b8996e824f0","ae6726c26e8f45cda22c30fb62b7892c","55b69135a2934d3cb2b3e1441606a10e","fc539e5b90834f128352d65ed1eef734","e5335b64f9494f6c9f4580154fc185a9","20ae1614bf5445a59c3beeb66b497d1e","06cb63ddb14c4f0b92910e6c4282c423","18812ed5717740d6be35a814128f370e","b6088ccc006345668c39c8cbd80b46fe"]},"id":"bEMOVsWrC9GD","executionInfo":{"status":"ok","timestamp":1637755109264,"user_tz":-60,"elapsed":34767,"user":{"displayName":"Frederik Niesner","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjS-rpAvcehenzUFe5XNA7F_HjIVdKRnRIwLRDH=s64","userId":"16681650301170974875"}},"outputId":"3a36cd70-e20d-4b60-a056-d83c6b261715"},"source":["embeddings_dataset = df.map(\n","    lambda x: {\"embeddings\": get_embeddings(x[\"description\"]).detach().cpu().numpy()[0]}\n",")\n","\n","\"\"\"embeddings_dataset = comments_dataset.map(\n","    lambda x: {\"embeddings\": get_embeddings(x[\"text\"]).detach().cpu().numpy()[0]}\n",")\"\"\""],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"ae17c6e8442440ba9aa1809d25eeec0f","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/500 [00:00<?, ?ex/s]"]},"metadata":{}},{"output_type":"execute_result","data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"},"text/plain":["'embeddings_dataset = comments_dataset.map(\\n    lambda x: {\"embeddings\": get_embeddings(x[\"text\"]).detach().cpu().numpy()[0]}\\n)'"]},"metadata":{},"execution_count":33}]},{"cell_type":"code","metadata":{"id":"vsYnfleBEqom"},"source":["import faiss"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":118,"referenced_widgets":["363d2b4e2eeb44938964bb6d4d7729eb","478ba08e72594a27ae5cc91ecef87b03","600b51e1fa9f4c4d9c6a952e7e85e63e","6c7d4744c1bb4157a94111f290f9139e","9be97f08433b4e21a14f64ea80a829e1","cee71482dbdf494ead47dac7855cd387","506e08a549a84aee954bb1ec6a6de1ef","77bfe03564724e9ab2aac9f3d332c437","6fd9439633864ab29593e75131860218","99a84ef6528845bcbd49f7021268f66f","b21fd6a9b82e42eaa0bc8c35597c816c"]},"id":"bh8KQMEkC9BD","executionInfo":{"status":"ok","timestamp":1637755124581,"user_tz":-60,"elapsed":206,"user":{"displayName":"Frederik Niesner","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjS-rpAvcehenzUFe5XNA7F_HjIVdKRnRIwLRDH=s64","userId":"16681650301170974875"}},"outputId":"1a2b385b-0b85-4c87-e7ad-062646a4bbdd"},"source":["embeddings_dataset.add_faiss_index(column=\"embeddings\")"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"363d2b4e2eeb44938964bb6d4d7729eb","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/1 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["Dataset({\n","    features: ['id', 'description', 'embeddings'],\n","    num_rows: 500\n","})"]},"metadata":{},"execution_count":35}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"OQtVz0_MC8_h","executionInfo":{"status":"ok","timestamp":1637755160291,"user_tz":-60,"elapsed":203,"user":{"displayName":"Frederik Niesner","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjS-rpAvcehenzUFe5XNA7F_HjIVdKRnRIwLRDH=s64","userId":"16681650301170974875"}},"outputId":"2df45687-792a-4123-dcec-34450d587666"},"source":["question = \"Shorts from H&M\"\n","question_embedding = get_embeddings([question]).cpu().detach().numpy()\n","question_embedding.shape"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(1, 768)"]},"metadata":{},"execution_count":36}]},{"cell_type":"code","metadata":{"id":"Qn6gn-IDC89K"},"source":["scores, samples = embeddings_dataset.get_nearest_examples(\n","    \"embeddings\", question_embedding, k=5\n",")"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"vjMImSKWC86l"},"source":["import pandas as pd\n","\n","samples_df = pd.DataFrame.from_dict(samples)\n","samples_df[\"scores\"] = scores\n","samples_df.sort_values(\"scores\", ascending=False, inplace=True)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"vEUljXiTDcR6","executionInfo":{"status":"ok","timestamp":1637755217316,"user_tz":-60,"elapsed":231,"user":{"displayName":"Frederik Niesner","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjS-rpAvcehenzUFe5XNA7F_HjIVdKRnRIwLRDH=s64","userId":"16681650301170974875"}},"outputId":"595d92b2-b498-4e42-fcec-aa83e35293b1"},"source":["for _, row in samples_df.iterrows():\n","    print(f\"DESCRIPTION: {row.description}\")\n","    print(f\"SCORE: {row.scores}\")\n","    #print(f\"TITLE: {row.title}\")\n","    #print(f\"URL: {row.html_url}\")\n","    print(\"=\" * 50)\n","    print()"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["DESCRIPTION: Baggies shorts - Even Baggies, our most popular shorts for anything, or nothing, occasionally need an update. This season we've increased the inseam length. Their casual fit, quick-drying water-repellent nylon and elasticized waistband with an internal drawstring remain the same as ever. Other features include a polyester mesh lining, a rear snap pocket and front pockets (with self-draining mesh corners) positioned to reduce drag in the water. Inseam (size M) is 7\". Recyclable through the Common Threads Recycling Program.<br><br><b>Details:</b><ul> <li>Quick-drying nylon with a DWR (durable water repellent) finish</li> <li>Elasticized waistband with internal drawstring; black mesh liner</li> <li>Vertical on-seam side pockets for reduced drag in the water; pocket bags have quick-drain-and-dry mesh corners; snap-closed back pocket</li> <li>\"Inseam is 7\"\"\"</li></ul><br><br><b>Fabric: </b>4.2-oz 100% nylon with a DWR finish. Lining: 5.2-oz 100% polyester mesh. Recyclable through the Common Threads Recycling Program<br><br><b>Weight: </b>(233 g 8.1 oz)<br><br>Made in Nicaragua.\n","SCORE: 31.64947509765625\n","==================================================\n","\n","DESCRIPTION: Solimar shorts - Horny toads and other professional heat regulators seek shade. Let our new Solimar Shorts provide yours. Made of a tightly woven (30 UPF) lightweight stretch nylon with a DWR (durable water repellent) finish, the shorts are cut longer but can be rolled up and secured with button fasteners. They have two front patch pockets with welted openings and a single thigh mini drop-in pocket. Backside seams and darts provide shaping and the straight legs have vented hems. Regular rise; inseam (size 8) is 15\". Recyclable through the Common Threads Recycling Program.<br><br><b>Details:</b><ul> <li>Lightweight stretch fabric with 30-UPF protection and DWR (durable water repellent) finish</li> <li>Waistband with belt loops</li> <li>Zip fly with button closure</li> <li>Patch front pockets with welt openings; mini drop-in pocket on right thigh</li> <li>Straight leg; back seaming and dart for shaping</li> <li>Regular rise</li> <li>\"Inseam is 10\"\"\"</li></ul><br><br><b>Fabric: </b>\"3-oz 93% nylon/7% spandex, with 30-UPF sun protection. Recyclable through the Common Threads Recycling Program\"<br><br><b>Weight: </b>(126 g 4.4 oz)<br><br>Made in Vietnam.\n","SCORE: 30.908763885498047\n","==================================================\n","\n","DESCRIPTION: Shop pants - short - More at home under the truck than inside it, our Shop Pants are made from garment-washed 10-oz 100% organic cotton canvas that's tool-resistant yet breaks in easily. They have a shaped waist, jeans-style pocketing, steel rivets, double-fabric knees and reinforced \"mud flaps\" above the cuffs. Inseams (size 32): regular is 32\";  short is 30\" and long 34\". Recyclable through the Common Threads Recycling Program.<br><br><b>Details:</b><ul> <li>\"Made from 10-oz year-round weight organic cotton canvas for a tough, yet skin-friendly feel\"</li> <li>Waistband slightly lower in front for fit and mobility</li> <li>Zip fly with button closure</li> <li>5-pocket jeans styling</li> <li>Patch pockets on back</li> <li>Double-fabric knees; straight legs</li> <li>\"Inseam length is 30\"\"\"</li></ul><br><br><b>Fabric: </b>10-oz 100% organic cotton canvas. Recyclable through the Common Threads Recycling Program<br><br><b>Weight: </b>538 g (19 oz)<br><br>Made in Thailand.\n","SCORE: 30.706663131713867\n","==================================================\n","\n","DESCRIPTION: Active boy shorts - We've worn these versatile, feminine boy shorts as on-the-fly bathing suit bottoms, to Bikram yoga class, as sleepwear - their functionality is limitless. Low-rise Active Boy Shorts are tube-constructed to eliminate chafing side seams, and their soft, technical fabric breathes and wicks moisture to keep you comfortable and dry. We've shortened the flat waistband in front for a fit that won't roll or bind; stretchy shaped openings at legs are newly redesigned with less fabric to minimize bunching. Solids and prints: 4.6-oz 93% nylon/7% spandex.<br><br><b>Details:</b><ul> <li>\"Ultrasoft, lightweight fabric with stretch and moisture management\"</li> <li>Seamless construction</li> <li>\"Waistband and shaped leg openings lie flat, won't roll or bind for well deserved comfort and mobility\"</li></ul><br><br><b>Fabric: </b>\"4.6-oz 93% nylon/7% spandex, with moisture-wicking performance\"<br><br><b>Weight: </b>(31 g 1.1 oz)<br><br>Made in Israel.\n","SCORE: 30.619386672973633\n","==================================================\n","\n","DESCRIPTION: Retro grade shorts - As advantageous as a number 2 cam, Retro Grades just seem to go anywhere. They have a soft yet durable blend of 98% organic cotton and 2% spandex that stays cool and slides smoothly over skin. A gusseted crotch and articulation at the knees lets you move unchallenged. Built with a soft waist (with internal drawstring) and harness-compatible belt loops, they feature a relaxed fit and a 5-pocket design that includes a security pocket on the right side seam. Our longest shorts, the inseam (size M) is 16\". Recyclable through the Common Threads Recycling Program.<br><br><b>Details:</b><ul> <li>Soft yet durable organic cotton/spandex with stretch; easy slide next to skin</li> <li>5-pocket styling in a relaxed fit; grown-on waistband for harness comfort</li> <li>Internal synthetic drawstring; Gusseted crotch</li> <li>\"Angled, easy-access zippered security pocket at side seam\"</li> <li>Double layered fabric at the knee</li> <li>Articulation in the knees</li> <li>\"Inseam is 16\"\"\"</li></ul><br><br><b>Fabric: </b>8-oz 98% organic cotton/2% spandex. Recyclable through the Common Threads Recycling Program<br><br><b>Weight: </b>(458 g 15.9 oz)<br><br>Made in Vietnam.\n","SCORE: 27.687885284423828\n","==================================================\n","\n"]}]},{"cell_type":"code","metadata":{"id":"phaWo5mvDfZb"},"source":[""],"execution_count":null,"outputs":[]}]}